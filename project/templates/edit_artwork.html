{% extends "base.html" %}
{% set active_page = 'vendor_manage' %} {# highlights the navbar item #}
{% block title %}Edit Artwork{% endblock %}

{% block content %}
<section class="mb-5 my-4">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-9 col-xl-8">

        <header class="mb-4">
          <div class="d-flex align-items-center justify-content-between">
            <h1 class="h3 colour__header mb-0">Edit Artwork</h1>
            <a href="{{ url_for('main.vendor_manage') }}" class="btn btn-outline-secondary">
              Back to Vendor Management
            </a>
          </div>
        </header>

        <div class="card shadow-sm border-1">
          <div class="card-body p-4 p-md-5">

            {% if form.errors %}
            <div class="alert alert-danger small mb-4">
              Please check the highlighted fields and try again.
            </div>
            {% endif %}

            {# Preview (static-only, same style as other pages) #}
            {% if artwork and artwork.imageLink %}
            <img src="{{ url_for('static', filename=artwork.imageLink) }}" alt="{{ artwork.title or 'Artwork image' }}"
              class="img-fluid rounded mb-3" style="max-height:220px">
            {% endif %}


            <form method="post" action="{{ url_for('main.vendor_edit_artwork', artwork_id=artwork.artwork_id) }}"
              class="row g-3">
              {{ form.csrf_token }}

              {# Vendor is fixed to 'Me' but we keep the field for validation round-trip #}
              {{ form.vendor_id(type="hidden", value=form.vendor_id.data) }}

              <div class="col-md-8">
                <label class="form-label" for="{{ form.title.id }}">Title</label>
                {{ form.title(class_="form-control", required=True) }}
                {% for e in form.title.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
              </div>

              <div class="col-md-4">
                <label class="form-label" for="{{ form.category_id.id }}">Category</label>
                {{ form.category_id(class_="form-select") }}
                {% for e in form.category_id.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
              </div>

              <div class="col-md-4">
                <label class="form-label" for="{{ form.pricePerWeek.id }}">Price per week (AUD)</label>
                {{ form.pricePerWeek(class_="form-control", required=True) }}
                {% for e in form.pricePerWeek.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
              </div>

              <div class="col-md-4">
                <label class="form-label" for="{{ form.maxQuantity.id }}">Max quantity</label>
                {{ form.maxQuantity(class_="form-control", required=True) }}
                {% for e in form.maxQuantity.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
              </div>

              <div class="col-md-4">
                <label class="form-label" for="{{ form.availabilityStatus.id }}">Status</label>
                {{ form.availabilityStatus(class_="form-select", required=True) }}
                {% for e in form.availabilityStatus.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{%
                endfor %}
              </div>

              <div class="col-md-6">
                <label class="form-label" for="{{ form.availabilityStartDate.id }}">Available from</label>
                {{ form.availabilityStartDate(class_="form-control", placeholder="YYYY-MM-DD") }}
                {% for e in form.availabilityStartDate.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{%
                endfor %}
              </div>

              <div class="col-md-6">
                <label class="form-label" for="{{ form.availabilityEndDate.id }}">Available until</label>
                {{ form.availabilityEndDate(class_="form-control", placeholder="YYYY-MM-DD") }}
                {% for e in form.availabilityEndDate.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{%
                endfor %}
              </div>

              <div class="col-12">
                <label class="form-label" for="{{ form.imageLink.id }}">Image</label>
                {{ form.imageLink(class_="form-control", placeholder="/img/filename.jpg", required=True)
                }}
                {% for e in form.imageLink.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor %}
              </div>

              <div class="col-12">
                <label class="form-label" for="{{ form.itemDescription.id }}">Description</label>
                {{ form.itemDescription(class_="form-control", rows="5", required=True) }}
                {% for e in form.itemDescription.errors %}<div class="invalid-feedback d-block">{{ e }}</div>{% endfor
                %}
              </div>

              <div class="col-12 d-flex gap-2">
                <button class="btn colour__button__2" type="submit">Save changes</button>
                <a href="{{ url_for('main.vendor_manage') }}" class="btn btn-outline-secondary">Cancel</a>
              </div>
            </form>
          </div>
        </div>

      </div>
    </div>
  </div>
</section>
{% endblock %}